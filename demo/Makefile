PWD := $(shell pwd)
BRAD := "-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEA5udo4LTGlHkSsxcrqEXiEJ8zZXuhtVWgibKquPKg/d0w3yEH\nLFHuerrgLoTDxSjwmEDR7n4ZpSpBT73786BLe8K0LtjHaQxf9ZRvfptyd/w1Rw5D\nKKKYSwL3y6Cl9fd6xEDWby7WyqHN+/aXYgFIbVz/JDEqYxllKbyhvnXCp+FpuO5J\nI0K0AcO+s03g+7XJ5D0ObcKHFuaVHz6lETlAYZyB+162fiqGyCGazpkExtF7eSAp\nJRQECh0djpLgu545BdF11Qw+pFVQ+BUss1ngxbhDzuQ+okkSAXrJpDiQs7JNqT3V\nmDDWh+uhM9BDGmiJC7WpdyCl6QteKVV2qYqbSQIDAQABAoIBAQCX8bOMGqmKTlnF\ny/uIkeP/OCPkJgT1hNFNi2rYpaDXLVTZn6xOt+OMk6iuM+N3vEcGibEblZNeon2z\n8br4SIUjfa6AHVqrf98thW4RDE25MxgEGBiNhuFciylwr9hGEYKR3nC9XT8uvGcF\n5PEdJub4QHgM4uWXrMBrRJvS7z8WpPhtGLDUadJ9+2Dj5w0EVmZZ1O/rsPeGud/k\nPEAMXPLGCCDMM2lmi58Xqvg4M+cTlDY4p3FAWhwFVWQdFsRYhf0odf3LzvTJoUgp\nQ2I5eT4/n7fHFErpC/fEwMYb7xO7K3tLiFBxrbTRJ+ebzEHSnrOo6vevJ1Twfq0p\n7+0b2Y5ZAoGBAPyDUyMe0q0Pii0/MirQSWMCJeAmgcCL+vxHVRDMkGLgYpMEgAsy\nVAB92BvHtYeL2SRwpIBiwRLtSR/apN/7JvkVUdGCOhPAswUaIl9FkmMeICh5CkcE\nauJpoqMjQExCEZSY5VjbalcsLQnBzg9HfbEWPFzbVte2QYUnOLI8KefbAoGBAOoX\nsYEYHim7nRNgC2rhPNNw6s3TL2xN0VUEVlm5CWo+Z352Jnl4C0BIu0GU1PArB6sM\nJ07RDJ7jnpfcQRmIhacSCuaws6cIfyfqLfPmyKTjGQfJ/BmQLI+urua764fOIPOf\nkvU6cQznxc4qgNJTA+FgM3mvwFS2GN758BYGsPSrAoGBAKLC91yk6oEYiiU+HdUQ\n6qzB3q4LxAjbcY0ZYZBxewPwxDklZm9RImoqs5i8cpsLHozpem8yuGa9wiuhIDMr\nTOSyxEk6GrtOs1WvkcY9Lu1qpqnP0zsRct+73VQwTaqZz4EryHEtBO9pjyJB5NNe\nbnst7PyheOmUFcmBDX99XjmPAoGASfiEsZtSZLORNf8ifHqCAvpqZ/G0yY9pd2jw\ndFehHv5rK63gCIAjZgPVkCqcguvF94nWnfQ2/bpFcg06UPwv55Qu96icjEqGC7HX\nJXwmqNvOHAT6cYV6X0i+odB946MCDJm/EViPQpm2iqgpnsx2rG/+tBQSPXJxN3xZ\nHkys/BMCgYEAkunD2975ehFKsOq0EcH58WUQPftqQGey6vHAhAWgCWqIFKESBRhU\nkfLzWJjrkMGCTRetGh/FmddFZRZUyLPuZw3m4UEfY/QIQW60bG/d0Y2D9l2jHYuO\nvhXUmZkFJmAWsRktbAyV1sBpY+Ve6y067muAPTH+ghtofDvMBRTU6/4=\n-----END RSA PRIVATE KEY-----"
all:
	docker run --rm -e PLUGIN_PLAYBOOK="playbook.yml" -e PLUGIN_INVENTORY="hosts" -e PLUGIN_GALAXY="requirements.yml" -e PLUGIN_REQUIREMENTS="requirements.txt" -e ANSIBLE_GALAXY_IGNORE=true -v $(PWD):$(PWD) -w $(PWD) plugins/ansible
test:
	docker run --rm -e ANSIBLE_USER=root -e ANSIBLE_PRIVATE_KEY=$(BRAD) -e ANSIBLE_EXTRA_VARS="clean_up=present" -e ANSIBLE_PYTHON_INTERPRETER=auto_silent -e PLUGIN_PLAYBOOK="create_host_with_iqn.yml" -e PLUGIN_INVENTORY="hosts" -e PLUGIN_GALAXY="requirements.yml" -e PLUGIN_REQUIREMENTS="requirements.txt" -e ANSIBLE_GALAXY_IGNORE=true -v $(PWD):$(PWD) -w $(PWD) plugins/ansible
cleanup:
	docker run --rm -e ANSIBLE_EXTRA_VARS="clean_up=absent" -e ANSIBLE_PYTHON_INTERPRETER=auto_silent -e PLUGIN_PLAYBOOK="create_host_hg.yml" -e PLUGIN_INVENTORY="hosts" -e PLUGIN_GALAXY="requirements.yml" -e PLUGIN_REQUIREMENTS="requirements.txt" -e ANSIBLE_GALAXY_IGNORE=true -v $(PWD):$(PWD) -w $(PWD) plugins/ansible
